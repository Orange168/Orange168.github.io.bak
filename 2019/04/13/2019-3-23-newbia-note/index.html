<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Basic,Linux," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="第五章、Linux  的文件权限与目录配置用户管理[root@study ~]# groupadd project        交换区总量, 3998716 free－－&amp;gt;空闲交换区总量, 0 used－－&amp;gt;使用的交换区总量. 3327816 avail Mem－－&amp;gt;   进程信息 PID－－&amp;gt;进程ＩＤ  USER－－&amp;gt;用户  PR－－&amp;gt;优先级  NI－－&amp;gt;nice值。负值表示高优先级，正值表示">
<meta name="keywords" content="Basic,Linux">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 菜鸟私房菜知识架构">
<meta property="og:url" content="http://zhilinchn.online/2019/04/13/2019-3-23-newbia-note/index.html">
<meta property="og:site_name" content="北疆的博客">
<meta property="og:description" content="第五章、Linux  的文件权限与目录配置用户管理[root@study ~]# groupadd project        交换区总量, 3998716 free－－&amp;gt;空闲交换区总量, 0 used－－&amp;gt;使用的交换区总量. 3327816 avail Mem－－&amp;gt;   进程信息 PID－－&amp;gt;进程ＩＤ  USER－－&amp;gt;用户  PR－－&amp;gt;优先级  NI－－&amp;gt;nice值。负值表示高优先级，正值表示">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://img-blog.csdn.net/20180611104357519?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NkMTk5MzA1MDg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">
<meta property="og:updated_time" content="2019-06-05T04:09:11.768Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux 菜鸟私房菜知识架构">
<meta name="twitter:description" content="第五章、Linux  的文件权限与目录配置用户管理[root@study ~]# groupadd project        交换区总量, 3998716 free－－&amp;gt;空闲交换区总量, 0 used－－&amp;gt;使用的交换区总量. 3327816 avail Mem－－&amp;gt;   进程信息 PID－－&amp;gt;进程ＩＤ  USER－－&amp;gt;用户  PR－－&amp;gt;优先级  NI－－&amp;gt;nice值。负值表示高优先级，正值表示">
<meta name="twitter:image" content="https://img-blog.csdn.net/20180611104357519?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NkMTk5MzA1MDg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: 'CD2IHLO3Q2',
      apiKey: 'f3890b1e9cf212771f29d3258b186372',
      indexName: 'LocalSearch',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://zhilinchn.online/2019/04/13/2019-3-23-newbia-note/"/>





  <title> Linux 菜鸟私房菜知识架构 | 北疆的博客 </title>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?dd275ba96bfa28cb8bd3809466f17419";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">北疆的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>


<li> <a title="把这个链接拖到你的Chrome收藏夹工具栏中" href='javascript:(function() {
    function c() {
        var e = document.createElement("link");
        e.setAttribute("type", "text/css");
        e.setAttribute("rel", "stylesheet");
        e.setAttribute("href", f);
        e.setAttribute("class", l);
        document.body.appendChild(e)
    }

    function h() {
        var e = document.getElementsByClassName(l);
        for (var t = 0; t < e.length; t++) {
            document.body.removeChild(e[t])
        }
    }

    function p() {
        var e = document.createElement("div");
        e.setAttribute("class", a);
        document.body.appendChild(e);
        setTimeout(function() {
            document.body.removeChild(e)
        }, 100)
    }

    function d(e) {
        return {
            height : e.offsetHeight,
            width : e.offsetWidth
        }
    }

    function v(i) {
        var s = d(i);
        return s.height > e && s.height < n && s.width > t && s.width < r
    }

    function m(e) {
        var t = e;
        var n = 0;
        while (!!t) {
            n += t.offsetTop;
            t = t.offsetParent
        }
        return n
    }

    function g() {
        var e = document.documentElement;
        if (!!window.innerWidth) {
            return window.innerHeight
        } else if (e && !isNaN(e.clientHeight)) {
            return e.clientHeight
        }
        return 0
    }

    function y() {
        if (window.pageYOffset) {
            return window.pageYOffset
        }
        return Math.max(document.documentElement.scrollTop, document.body.scrollTop)
    }

    function E(e) {
        var t = m(e);
        return t >= w && t <= b + w
    }

    function S() {
        var e = document.createElement("audio");
        e.setAttribute("class", l);
        e.src = i;
        e.loop = false;
        e.addEventListener("canplay", function() {
            setTimeout(function() {
                x(k)
            }, 500);
            setTimeout(function() {
                N();
                p();
                for (var e = 0; e < O.length; e++) {
                    T(O[e])
                }
            }, 15500)
        }, true);
        e.addEventListener("ended", function() {
            N();
            h()
        }, true);
        e.innerHTML = " <p>If you are reading this, it is because your browser does not support the audio element. We recommend that you get a new browser.</p> <p>";
        document.body.appendChild(e);
        e.play()
    }

    function x(e) {
        e.className += " " + s + " " + o
    }

    function T(e) {
        e.className += " " + s + " " + u[Math.floor(Math.random() * u.length)]
    }

    function N() {
        var e = document.getElementsByClassName(s);
        var t = new RegExp("\\b" + s + "\\b");
        for (var n = 0; n < e.length; ) {
            e[n].className = e[n].className.replace(t, "")
        }
    }

    var e = 30;
    var t = 30;
    var n = 350;
    var r = 350;
    var i = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake.mp3";
    var s = "mw-harlem_shake_me";
    var o = "im_first";
    var u = ["im_drunk", "im_baked", "im_trippin", "im_blown"];
    var a = "mw-strobe_light";
    var f = "//s3.amazonaws.com/moovweb-marketing/playground/harlem-shake-style.css";
    var l = "mw_added_css";
    var b = g();
    var w = y();
    var C = document.getElementsByTagName("*");
    var k = null;
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            if (E(A)) {
                k = A;
                break
            }
        }
    }
    if (A === null) {
        console.warn("Could not find a node of the right size. Please try a different page.");
        return
    }
    c();
    S();
    var O = [];
    for (var L = 0; L < C.length; L++) {
        var A = C[L];
        if (v(A)) {
            O.push(A)
        }
    }
})()    '>High一下</a> </li>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://zhilinchn.online/2019/04/13/2019-3-23-newbia-note/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="北疆">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://ohlb58e07.bkt.clouddn.com/avatar_github_blog.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="北疆的博客">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="北疆的博客" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Linux 菜鸟私房菜知识架构
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-13T01:34:06+08:00">
                2019-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/note/" itemprop="url" rel="index">
                    <span itemprop="name">note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2019/04/13/2019-3-23-newbia-note/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/04/13/2019-3-23-newbia-note/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 浏览
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="第五章、Linux-的文件权限与目录配置"><a href="#第五章、Linux-的文件权限与目录配置" class="headerlink" title="第五章、Linux  的文件权限与目录配置"></a>第五章、Linux  的文件权限与目录配置</h1><h2 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h2><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# groupadd project        <==增加新的群组 
[root@study ~]# useradd -G project alex <==建立 alex 账号，且支持 project 
[root@study ~]# useradd -G project arod <==建立 arod 账号，且支持 project 
[root@study ~]# id alex                 <==查阅 alex 账号的属性 
uid=1001(alex) gid=1002(alex) groups=1002(alex),1001(project) <==确实有支持！ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="man-page"><a href="#man-page" class="headerlink" title="man page"></a>man page</h2><table>
<thead>
<tr>
<th style="text-align:center">按键</th>
<th style="text-align:center">header 2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">空格</td>
<td style="text-align:center">下翻一页</td>
</tr>
<tr>
<td style="text-align:center">home</td>
<td style="text-align:center">去到第一页</td>
</tr>
<tr>
<td style="text-align:center">End</td>
<td style="text-align:center">去到最后一页</td>
</tr>
<tr>
<td style="text-align:center">/？string</td>
<td style="text-align:center">向下/上搜索</td>
</tr>
</tbody>
</table>
<h2 id="文件权限与配置"><a href="#文件权限与配置" class="headerlink" title="文件权限与配置"></a>文件权限与配置</h2><pre class="line-numbers language-shell"><code class="language-shell">chgrp ：改变文件所属群组 
chown ：改变文件拥有者 
chmod ：改变文件的权限, SUID, SGID, SBIT 等等的特性 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-shell"><code class="language-shell"> #将file_new的拥有者与群组改回为 chown user:group file
 chown root:root file_new 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>chmod </p>
<pre class="line-numbers language-shell"><code class="language-shell">        u 
        g      +(加入)  r:4
chmod   o      -(除去)  w:2    file
        a      =(设定)  x:1

 chmod  u=rwx,go=rx  .bashrc 
 #拿掉全部人的可执行权限
  chmod  a-x  .bashrc 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="文件与目录管理"><a href="#文件与目录管理" class="headerlink" title="文件与目录管理"></a>文件与目录管理</h2><h3 id="cp-mv"><a href="#cp-mv" class="headerlink" title="cp,mv"></a>cp,mv</h3><ul>
<li>cp (复制文件或目录) </li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# cp [options] source1 source2 source3 .... directory 
选项与参数： 
-a  ：相当于 -dr --preserve=all 的意思，至于 dr 请参考下列说明；(常用) 
-d  ：若来源文件为链接文件的属性(link file)，则复制链接文件属性而非文件本身； 
-f  ：为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次； 
-i  ：若目标文件(destination)已经存在时，在覆盖时会先询问动作的进行(常用) 
-l  ：进行硬式连结(hard link)的连结档建立，而非复制文件本身； 
-p  ：连同文件的属性(权限、用户、时间)一起复制过去，而非使用默认属性(备份常用)； 
-r  ：递归持续复制，用于目录的复制行为；(常用) 
-s  ：复制成为符号链接文件 (symbolic link)，亦即『快捷方式』文件； 
-u  ：destination 比 source 旧才更新 destination，或 destination 不存在的情况下才复制。 
--preserve=all ：除了 -p 的权限相关参数外，还加入 SELinux 的属性, links, xattr 等也复制了。 
最后需要注意的，如果来源档有两个以上，则最后一个目的文件一定要是『目录』才行！ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><p>mv </p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# mv [-fiu] source destination 
选项与参数： 
-f  ：force 强制的意思，如果目标文件已经存在，不会询问而直接覆盖； 
-i  ：若目标文件 (destination) 已经存在时，就会询问是否覆盖！ 
-u  ：若目标文件已经存在，且 source 比较新，才会更新 (update) 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="文件名与目录名称"><a href="#文件名与目录名称" class="headerlink" title="文件名与目录名称"></a>文件名与目录名称</h3><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# basename /etc/sysconfig/network 
network         <== 很简单！就取得最后的档名～ 
[root@study ~]# dirname /etc/sysconfig/network 
/etc/sysconfig  <== 取得的变成目录名了！ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="文件内容查阅"><a href="#文件内容查阅" class="headerlink" title="文件内容查阅"></a>文件内容查阅</h3><ul>
<li><p>cat [-AbEnTv]  / tac（反向显示）</p>
<pre class="line-numbers language-shell"><code class="language-shell">选项与参数： 
-A  ：相当于 -vET 的整合选项，可列出一些特殊字符而不是空白而已； 
-b  ：列出行号，仅针对非空白行做行号显示，空白行不标行号！ 
-E  ：将结尾的断行字符 $ 显示出来； 
-n  ：打印出行号，连同空白行也会有行号，与 -b 的选项不同； 
-T  ：将 [tab] 按键以 ^I 显示出来； 
-v  ：列出一些看不出来的特殊字符 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>nl (添加行号打印) z</p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# nl [-bnw] 文件 
选项与参数： 
-b  ：指定行号指定的方式，主要有两种： 
      -b a ：表示不论是否为空行，也同样列出行号(类似 cat -n)； 
      -b t ：如果有空行，空的那一行不要列出行号(默认值)； 
-n  ：列出行号表示的方法，主要有三种： 
      -n ln ：行号在屏幕的最左方显示； 
      -n rn ：行号在自己字段的最右方显示，且不加 0 ； 
      -n rz ：行号在自己字段的最右方显示，且加 0 ； 
-w  ：行号字段的占用的字符数。 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="文件预设权限：umask"><a href="#文件预设权限：umask" class="headerlink" title="文件预设权限：umask"></a>文件预设权限：umask</h3><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# umask 
0022             <==与一般权限有关的是后面三个数字！ 
[root@study ~]# umask -S 
u=rwx,g=rx,o=rx 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="文件隐藏属性"><a href="#文件隐藏属性" class="headerlink" title="文件隐藏属性"></a>文件隐藏属性</h3><h4 id="chattr"><a href="#chattr" class="headerlink" title="chattr"></a>chattr</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# chattr [+-=][ASacdistu] 文件或目录名称 
选项与参数： 
+   ：增加某一个特殊参数，其他原本存在参数则不动。 
-   ：移除某一个特殊参数，其他原本存在参数则不动。 
=   ：设定一定，且仅有后面接的参数 

A  ：当设定了 A 这个属性时，若你有存取此文件(或目录)时，他的访问时间 atime 将不会被修改， 
     可避免 I/O 较慢的机器过度的存取磁盘。(目前建议使用文件系统挂载参数处理这个项目) 
S  ：一般文件是异步写入磁盘的(原理请参考前一章 sync 的说明)，如果加上 S 这个属性时， 
     当你进行任何文件的修改，该更动会『同步』写入磁盘中。 
a  ：当设定 a 之后，这个文件将只能增加数据，而不能删除也不能修改数据，只有 root 才能设定这属性 
c  ：这个属性设定之后，将会自动的将此文件『压缩』，在读取的时候将会自动解压缩， 
     但是在储存的时候，将会先进行压缩后再储存(看来对于大文件似乎蛮有用的！) 
d  ：当 dump 程序被执行的时候，设定 d 属性将可使该文件(或目录)不会被 dump 备份 
i  ：这个 i 可就很厉害了！他可以让一个文件『不能被删除、改名、设定连结也无法写入或新增数据！』 
     对于系统安全性有相当大的帮助！只有 root 能设定此属性 
s  ：当文件设定了 s 属性时，如果这个文件被删除，他将会被完全的移除出这个硬盘空间， 
     所以如果误删了，完全无法救回来了喔！ 
u  ：与 s 相反的，当使用 u 来配置文件案时，如果该文件被删除了，则数据内容其实还存在磁盘中， 
     可以使用来救援该文件喔！ 
注意 1：属性设定常见的是 a 与 i 的设定值，而且很多设定值必须要身为 root 才能设定 
注意 2：xfs 文件系统仅支援 AadiS 而已 
范例：请尝试到/tmp 底下建立文件，并加入 i 的参数，尝试删除看看。 

[root@study ~]# cd /tmp 
[root@study tmp]# touch attrtest     <==建立一个空文件 
[root@study tmp]# chattr +i attrtest <==给予 i 的属性 
[root@study tmp]# rm attrtest        <==尝试删除看看 
rm: remove regular empty file `attrtest'? y 
rm: cannot remove `attrtest': Operation not permitted 
# 看到了吗？呼呼！连 root 也没有办法将这个文件删除呢！赶紧解除设定！ 

范例：请将该文件的 i 属性取消！ 
[root@study tmp]# chattr -i attrtest 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="lsattr-显示文件隐藏属性"><a href="#lsattr-显示文件隐藏属性" class="headerlink" title="lsattr (显示文件隐藏属性)"></a>lsattr (显示文件隐藏属性)</h4><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# lsattr [-adR] 文件或目录 
选项与参数： 
-a ：将隐藏文件的属性也秀出来； 
-d ：如果接的是目录，仅列出目录本身的属性而非目录内的文件名； 
-R ：连同子目录的数据也一并列出来！  

[root@study tmp]# chattr +aiS attrtest 
[root@study tmp]# lsattr attrtest 
--S-ia---------- attrtest 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="文件特殊权限："><a href="#文件特殊权限：" class="headerlink" title="文件特殊权限："></a>文件特殊权限：</h3><p><code>-rwsr-xr-x</code> Set UID </p>
<ul>
<li>二进制可执行</li>
<li>运行拥有owner权限</li>
</ul>
<blockquote>
<p>SUID  仅可用在 binary program  上，  不能够用在  shell script  上面！</p>
</blockquote>
<p><code>-rwx--s--x.</code> Set GID </p>
<ul>
<li>二进制可执行</li>
<li>运行拥有Group权限</li>
</ul>
<p><code>drwxrwxrwt</code>  Sticky Bit 目录有效，文件无效</p>
<ul>
<li>用户具有w,x</li>
<li>当用户在该目录下建立文件或目录时，仅有自己与  root  才有权力删除该文件</li>
</ul>
<pre class="line-numbers language-shell"><code class="language-shell">4  为  SUID 
2  为  SGID 
1  为  SBIT 
file 设置 -rwsr-xr-x ==> chmod 4755 filename (4 + 755) 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study tmp]# chmod 6755 test; ls -l test <==加入具有 SUID/SGID 的权限 
-rwsr-sr-x 1 root root 0 Jun 16 02:53 test 
[root@study tmp]# chmod 1755 test; ls -l test <==加入 SBIT 的功能！ 
-rwxr-xr-t 1 root root 0 Jun 16 02:53 test 
[root@study tmp]# chmod 7666 test; ls -l test <==具有空的 SUID/SGID 权限 
-rwSrwSrwT 1 root root 0 Jun 16 02:53 test 

SUID  为  u+s  ，而  SGID  为  g+s  ，SBIT 则是  o+t 

# 设定权限成为 -rws--x--x 的模样： 
[root@study tmp]# chmod u=rwxs,go=x test; ls -l test 
-rws--x--x 1 root root 0 Jun 16 02:53 test 

# 承上，加上 SGID 与 SBIT 在上述的文件权限中！ 
[root@study tmp]# chmod g+s,o+t test; ls -l test 
-rws--s--t 1 root root 0 Jun 16 02:53 test 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="脚本文件名的搜寻"><a href="#脚本文件名的搜寻" class="headerlink" title="脚本文件名的搜寻"></a>脚本文件名的搜寻</h2><h3 id="which-寻找『执行档』"><a href="#which-寻找『执行档』" class="headerlink" title="which (寻找『执行档』)"></a>which (寻找『执行档』)</h3><pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# which [-a] command 
选项或参数： 
-a ：将所有由 PATH 目录中可以找到的指令均列出，而不止第一个被找到的指令名称 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="whereis-由一些特定的目录中寻找文件文件名"><a href="#whereis-由一些特定的目录中寻找文件文件名" class="headerlink" title="whereis (由一些特定的目录中寻找文件文件名)"></a>whereis (由一些特定的目录中寻找文件文件名)</h3><blockquote>
<p>只找系统中某些特定目录底下的文件</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# whereis [-bmsu] 文件或目录名 
选项与参数： 
-l    :可以列出 whereis 会去查询的几个主要目录而已 
-b    :只找 binary 格式的文件 
-m    :只找在说明文件 manual 路径下的文件 
-s    :只找 source 来源文件 
-u    :搜寻不在上述三个项目当中的其他特殊文件 

范例一：请找出 ifconfig 这个档名 
[root@study ~]# whereis ifconfig  
ifconfig: /sbin/ifconfig /usr/share/man/man8/ifconfig.8.gz 

范例二：只找出跟 passwd 有关的『说明文件』档名(man page) 
[root@study ~]# whereis passwd     # 全部的档名通通列出来！ 
passwd: /usr/bin/passwd /etc/passwd /usr/share/man/man1/passwd.1.gz 
/usr/share/man/man5/passwd.5.gz 
[root@study ~]# whereis -m passwd  # 只有在 man 里面的档名才抓出来！ 
passwd: /usr/share/man/man1/passwd.1.gz /usr/share/man/man5/passwd.5.gz 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="locate-updatedb"><a href="#locate-updatedb" class="headerlink" title="locate / updatedb"></a>locate / updatedb</h3><blockquote>
<p>是利用数据库来搜寻文件名,『已建立的数据库  /var/lib/mlocate/</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# locate [-ir] keyword 
选项与参数： 
-i  ：忽略大小写的差异； 
-c  ：不输出档名，仅计算找到的文件数量 
-l  ：仅输出几行的意思，例如输出五行则是 -l 5 
-S  ：输出 locate 所使用的数据库文件的相关信息，包括该数据库纪录的文件/目录数量等 
-r  ：后面可接正规表示法的显示方式 

范例一：找出系统中所有与 passwd 相关的档名，且只列出 5 个 
[root@study ~]# locate -l 5 passwd 
/etc/passwd 
/etc/passwd- 
/etc/pam.d/passwd 
/etc/security/opasswd 
/usr/bin/gpasswd 

范例二：列出 locate 查询所使用的数据库文件之文件名与各数据数量 
[root@study ~]# locate -S 
Database /var/lib/mlocate/mlocate.db: 
        8,086 directories     # 总纪录目录数 
        109,605 files         # 总纪录文件数 
        5,190,295 bytes in file names 
        2,349,150 bytes used to store database 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>updatedb   更新数据库， updatedb  指令会去读取  /etc/updatedb.conf  这个配置文件的设定</p>
<h3 id="find"><a href="#find" class="headerlink" title="find"></a>find</h3><ul>
<li><p>时间相关</p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# find [PATH] [option] [action] 
选项与参数： 
1. 与时间有关的选项：共有 -atime, -ctime 与 -mtime ，以 -mtime 说明 
   -mtime  n ：n 为数字，意义为在 n 天之前的『一天之内』被更动过内容的文件； 
   -mtime +n ：列出在 n 天之前(不含 n 天本身)被更动过内容的文件档名； 
   -mtime -n ：列出在 n 天之内(含 n 天本身)被更动过内容的文件档名。 
   -newer file ：file 为一个存在的文件，列出比 file 还要新的文件档名 

范例一：将过去系统上面 24 小时内有更动过内容 (mtime) 的文件列出 
[root@study ~]# find / -mtime 0 
# 那个 0 是重点！0 代表目前的时间，所以，从现在开始到 24 小时前， 
# 有变动过内容的文件都会被列出来！那如果是三天前的 24 小时内？ 
# find / -mtime 3 有变动过的文件都被列出的意思！ 

范例二：寻找 /etc 底下的文件，如果文件日期比 /etc/passwd 新就列出 
[root@study ~]# find /etc -newer /etc/passwd 
# -newer 用在分辨两个文件之间的新旧关系是很有用的！ 

范例三：
  4 则是代表 4-5 那一天的文件档名：ex> find /var -mtime 4 
  -4 代表小于等于 4 天内的文件档名：ex> find /var -mtime -4 
  +4 代表大于等于 5 天前的檔名：ex> find /var -mtime +4
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>用户相关</p>
<pre class="line-numbers language-shell"><code class="language-shell">选项与参数： 
2. 与使用者或组名有关的参数： 
   -uid n ：n 为数字，这个数字是用户的账号 ID，亦即 UID ，这个 UID 是记录在 
            /etc/passwd 里面与账号名称对应的数字。这方面我们会在第四篇介绍。 
   -gid n ：n 为数字，这个数字是组名的 ID，亦即 GID，这个 GID 记录在 
            /etc/group，相关的介绍我们会第四篇说明～ 
   -user name ：name 为使用者账号名称喔！例如 dmtsai  
   -group name：name 为组名喔，例如 users ； 
   -nouser    ：寻找文件的拥有者不存在 /etc/passwd 的人！ 
   -nogroup   ：寻找文件的拥有群组不存在于 /etc/group 的文件！ 
                当你自行安装软件时，很可能该软件的属性当中并没有文件拥有者， 
                这是可能的！在这个时候，就可以使用 -nouser 与 -nogroup 搜寻。 

范例三：搜寻 /home 底下属于 dmtsai 的文件 
[root@study ~]# find /home -user dmtsai 
# 这个东西也很有用的～当我们要找出任何一个用户在系统当中的所有文件时， 
# 就可以利用这个指令将属于某个使用者的所有文件都找出来喔！ 

范例四：搜寻系统中不属于任何人的文件 
[root@study ~]# find / -nouser 
# 透过这个指令，可以轻易的就找出那些不太正常的文件。如果有找到不属于系统任何人的文件时， 
# 不要太紧张，那有时候是正常的～尤其是你曾经以原始码自行编译软件时。 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>文件类型</p>
<pre class="line-numbers language-shell"><code class="language-shell">3. 与文件权限及名称有关的参数： 
   -name filename：搜寻文件名为 filename 的文件； 
   -size [+-]SIZE：搜寻比 SIZE 还要大(+)或小(-)的文件。这个 SIZE 的规格有： 
                   c: 代表 byte， k: 代表 1024bytes。所以，要找比 50KB 
                   还要大的文件，就是『 -size +50k 』 
   -type TYPE    ：搜寻文件的类型为 TYPE 的，类型主要有：一般正规文件 (f), 装置文件 (b, c), 
                   目录 (d), 连结档 (l), socket (s), 及 FIFO (p) 等属性。 
   -perm mode  ：搜寻文件权限『刚好等于』 mode 的文件，这个 mode 为类似 chmod 
                 的属性值，举例来说， -rwsr-xr-x 的属性为 4755 ！ 
   -perm -mode ：搜寻文件权限『必须要全部囊括 mode 的权限』的文件，举例来说，                  我们要搜寻 -rwxr--r-- ，亦即 0744 的文件，使用 -perm -0744， 
                 当一个文件的权限为 -rwsr-xr-x ，亦即 4755 时，也会被列出来， 
                 因为 -rwsr-xr-x 的属性已经囊括了 -rwxr--r-- 的属性了。 
   -perm /mode ：搜寻文件权限『包含任一 mode 的权限』的文件，举例来说，我们搜寻 
                 -rwxr-xr-x ，亦即 -perm /755 时，但一个文件属性为 -rw------- 
                 也会被列出来，因为他有 -rw.... 的属性存在！ 

范例五：找出档名为 passwd 这个文件 
[root@study ~]# find / -name passwd 

范例五-1：找出文件名包含了 passwd 这个关键词的文件 
[root@study ~]# find / -name "*passwd*" 
# 利用这个 -name 可以搜寻档名啊！默认是完整文件名，如果想要找关键词， 
# 可以使用类似 * 的任意字符来处理 

范例六：找出 /run 目录下，文件类型为 Socket 的檔名有哪些？ 
[root@study ~]# find /run -type s 
# 这个 -type 的属性也很有帮助喔！尤其是要找出那些怪异的文件， 
# 例如 socket 与 FIFO 文件，可以用 find /run -type p 或 -type s 来找！ 

范例七：搜寻文件当中含有 SGID 或 SUID 或 SBIT 的属性 
[root@study ~]# find / -perm /7000  
# 所谓的 7000 就是 ---s--s--t ，那么只要含有 s 或 t 的就列出，所以当然要使用 /7000， 
# 使用 -7000 表示要同时含有 ---s--s--t 的所有三个权限。而只需要任意一个，就是 /7000 ～瞭乎？ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>额~外可进行的动作：</p>
<pre class="line-numbers language-shell"><code class="language-shell">4. 额外可进行的动作： 
   -exec command ：command 为其他指令，-exec 后面可再接额外的指令来处理搜寻到的结果。 
   -print        ：将结果打印到屏幕上，这个动作是预设动作！ 

范例八：将上个范例找到的文件使用 ls -l 列出来～ 
[root@study ~]# find /usr/bin /usr/sbin -perm /7000 -exec ls -l {} \; 
# 注意到，那个 -exec 后面的 ls -l 就是额外的指令，指令不支持命令别名， 
# 所以仅能使用 ls -l 不可以使用 ll 喔！注意注意！ 

范例九：找出系统中，大于 1MB 的文件 
[root@study ~]# find / -size +1M 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h1 id="第七章、Linux磁盘与文件系统"><a href="#第七章、Linux磁盘与文件系统" class="headerlink" title="第七章、Linux磁盘与文件系统"></a>第七章、Linux磁盘与文件系统</h1><h2 id="EXT2-inode"><a href="#EXT2-inode" class="headerlink" title="EXT2 inode"></a>EXT2 inode</h2><ul>
<li><p>dumpe2fs：  查询  Ext  家族  superblock  信息的指令 </p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# dumpe2fs [-bh] 装置文件名 
选项与参数： 
-b ：列出保留为坏轨的部分(一般用不到吧！？) 
-h ：仅列出 superblock 的数据，不会列出其他的区段内容！ 

范例：鸟哥的一块 1GB ext4 文件系统内容 
[root@study ~]# blkid   <==这个指令可以叫出目前系统有被格式化的装置 

/dev/vda3: UUID="12y99K-bv2A-y7RY-jhEW-rIWf-PcH5-SaiApN" TYPE="LVM2_member" 
/dev/vda5: UUID="e20d65d9-20d4-472f-9f91-cdcfb30219d6" TYPE="ext4"  <==看到 ext4 了！ 

[root@study ~]# dumpe2fs /dev/vda5 
dumpe2fs 1.42.9 (28-Dec-2013) 
Filesystem volume name:   <none>           # 文件系统的名称(不一定会有) 
Last mounted on:          <not available>  # 上一次挂载的目录位置 
Filesystem UUID:          e20d65d9-20d4-472f-9f91-cdcfb30219d6 
Filesystem magic number:  0xEF53           # 上方的 UUID 为 Linux 对装置的定义码 
Filesystem revision #:    1 (dynamic)      # 下方的 features 为文件系统的特征数据 
Filesystem features:      has_journal ext_attr resize_inode dir_index filetype extent 64bit  
 flex_bg sparse_super large_file huge_file uninit_bg dir_nlink extra_isize 
Filesystem flags:         signed_directory_hash 
Default mount options:    user_xattr acl   # 预设在挂载时会主动加上的挂载参数 
Filesystem state:         clean            # 这块文件系统的状态为何，clean 是没问题 
Errors behavior:          Continue 
Filesystem OS type:       Linux 
Inode count:              65536            # inode 的总数 
Block count:              262144           # block 的总数 
Reserved block count:     13107            # 保留的 block 总数 
Free blocks:              249189           # 还有多少的 block 可用数量 
Free inodes:              65525            # 还有多少的 inode 可用数量 
First block:              0 
Block size:               4096             # 单个 block 的容量大小 
Fragment size:            4096 
Group descriptor size:    64 
....(中间省略).... 
Inode size:               256              # inode 的容量大小！已经是 256 了喔！ 
....(中间省略).... 
Journal inode:            8 
Default directory hash:   half_md4 
Directory Hash Seed:      3c2568b4-1a7e-44cf-95a2-c8867fb19fbc 
Journal backup:           inode blocks 
Journal features:         (none) 
Journal size:             32M              # Journal 日志式数据的可供纪录总容量 
Journal length:           8192 
Journal sequence:         0x00000001 
Journal start:            0 

Group 0: (Blocks 0-32767)                  # 第一块 block group 位置 
  Checksum 0x13be, unused inodes 8181 
  Primary superblock at 0, Group descriptors at 1-1   # 主要 superblock 的所在喔！ 

 Reserved GDT blocks at 2-128 
  Block bitmap at 129 (+129), Inode bitmap at 145 (+145) 
  Inode table at 161-672 (+161)                       # inode table 的所在喔！ 
  28521 free blocks, 8181 free inodes, 2 directories, 8181 unused inodes 
  Free blocks: 142-144, 153-160, 4258-32767           # 底下两行说明剩余的容量有多少 
  Free inodes: 12-8192 
Group 1: (Blocks 32768-65535) [INODE_UNINIT]          # 后续为更多其他的 block group 喔！ 
....(底下省略).... 
# 由于数据量非常的庞大，因此鸟哥将一些信息省略输出了！上表与你的屏幕会有点差异。 
# 前半部在秀出 supberblock 的内容，包括标头名称(Label)以及 inode/block 的相关信息 
# 后面则是每个 block group 的个别信息了！您可以看到各区段数据所在的号码！ 
# 也就是说，基本上所有的数据还是与 block 的号码有关就是了！很重要！ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="文件系统的简单操作"><a href="#文件系统的简单操作" class="headerlink" title="文件系统的简单操作"></a>文件系统的简单操作</h2><ul>
<li><p>df：列出文件系统的整体磁盘使用量</p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# df [-ahikHTm] [目录或文件名] 
选项与参数： 
-a  ：列出所有的文件系统，包括系统特有的 /proc 等文件系统； 
-k  ：以 KBytes 的容量显示各文件系统； 
-m  ：以 MBytes 的容量显示各文件系统； 
-h  ：以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示； 
-H  ：以 M=1000K 取代 M=1024K 的进位方式； 
-T  ：连同该 partition 的 filesystem 名称 (例如 xfs) 也列出； 
-i  ：不用磁盘容量，而以 inode 的数量来显示 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>案例：</p>
<pre class="line-numbers language-shell"><code class="language-shell">范例一：将系统内所有的 filesystem 列出来！
[root@study ~]# df 
Filesystem              1K-blocks    Used Available Use% Mounted on 
/dev/mapper/centos-root  10475520 3409408   7066112  33% / 
devtmpfs                   627700       0    627700   0% /dev 
tmpfs                      637568      80    637488   1% /dev/shm 
范例二：将系统内的所有特殊文件格式及名称都列出来 
[root@study ~]# df -aT 
Filesystem              Type        1K-blocks    Used Available Use% Mounted on 
rootfs                  rootfs       10475520 3409368   7066152  33% / 
proc                    proc                0       0         0    - /proc 
sysfs                   sysfs               0       0         0    - /sys 
devtmpfs                devtmpfs       627700       0    627700   0% /dev 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>du：评估文件系统的磁盘使用量</p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# du [-ahskm] 文件或目录名称 
选项与参数： 
-a  ：列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已。 
-h  ：以人们较易读的容量格式 (G/M) 显示； 
-s  ：列出总量而已，而不列出每个各别的目录占用容量； 
-S  ：不包括子目录下的总计，与 -s 有点差别。 
-k  ：以 KBytes 列出容量显示； 
-m  ：以 MBytes 列出容量显示； 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>案例：</p>
<pre class="line-numbers language-shell"><code class="language-shell">范例一：列出目前目录下的所有文件容量 
[root@study ~]# du 
4       ./.cache/dconf  <==每个目录都会列出来 
4       ./.cache/abrt 
8       ./.cache 
....(中间省略).... 
0       ./test4 
4       ./.ssh          <==包括隐藏文件的目录 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="磁盘的分区、格式化、检验"><a href="#磁盘的分区、格式化、检验" class="headerlink" title="磁盘的分区、格式化、检验"></a>磁盘的分区、格式化、检验</h2><blockquote>
<p>使用逻辑： 你应该要透过  lsblk  或  blkid  先找到磁盘，再用  parted /dev/xxx print  来找出内部的分区表类型，之<br>后才用  gdisk  或  fdisk  来操作系统</p>
</blockquote>
<ul>
<li><p>lsblk  列出系统上的所有磁盘列表 </p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# lsblk [-dfimpt] [device] 
选项与参数： 
-d  ：仅列出磁盘本身，并不会列出该磁盘的分区数据 
-f  ：同时列出该磁盘内的文件系统名称 
-i  ：使用 ASCII 的线段输出，不要使用复杂的编码 (再某些环境下很有用) 
-m  ：同时输出该装置在 /dev 底下的权限数据 (rwx 的数据) 
-p  ：列出该装置的完整文件名！而不是仅列出最后的名字而已。 
-t  ：列出该磁盘装置的详细数据，包括磁盘队列机制、预读写的数据量大小等 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>blkid  列出装置的  UUID  等参数 </p>
</li>
<li><p>parted  列出磁盘的分区表类型与分区信息 </p>
<pre class="line-numbers language-shell"><code class="language-shell">范例一：列出 /dev/vda 磁盘的相关数据 
[root@study ~]# parted /dev/vda print 
Model: Virtio Block Device (virtblk)        # 磁盘的模块名称(厂商) 
Disk /dev/vda: 42.9GB                       # 磁盘的总容量 
Sector size (logical/physical): 512B/512B   # 磁盘的每个逻辑/物理扇区容量 
Partition Table: gpt                        # 分区表的格式 (MBR/GPT) 
Disk Flags: pmbr_boot 

Number  Start   End     Size    File system  Name  Flags      # 底下才是分区数据 
 1      1049kB  3146kB  2097kB                     bios_grub 
 2      3146kB  1077MB  1074MB  xfs 
 3      1077MB  33.3GB  32.2GB                     lvm 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h3 id="gdisk"><a href="#gdisk" class="headerlink" title="gdisk"></a>gdisk</h3><p>实践最简单Demo</p>
<pre class="line-numbers language-shell"><code class="language-shell">范例：由前一小节的 lsblk 输出，我们知道系统有个 /dev/vda，请观察该磁盘的分区与相关数据 
[root@study ~]# gdisk /dev/vda  <==仔细看，不要加上数字喔！ 
GPT fdisk (gdisk) version 0.8.6 

Partition table scan: 
  MBR: protective 
  BSD: not present 
  APM: not present 
  GPT: present 

Found valid GPT with protective MBR; using GPT.  <==找到了 GPT 的分区表！ 

Command (? for help):     <==这里可以让你输入指令动作，可以按问号 (?) 来查看可用指令 
Command (? for help): ? 
b       back up GPT data to a file 
c       change a partition's name 
d       delete a partition           # 删除一个分区 
i       show detailed information on a partition 
l       list known partition types 
n       add a new partition          # 增加一个分区 
o       create a new empty GUID partition table (GPT) 
p       print the partition table    # 印出分区表 (常用) 
q       quit without saving changes  # 不储存分区就直接离开 gdisk 
r       recovery and transformation options (experts only) 
s       sort partitions 
t       change a partition's type code 
v       verify disk 
w       write table to disk and exit # 储存分区操作后离开 gdisk 
x       extra functionality (experts only) 
?       print this menu 
Command (? for help):   

Command (? for help): p  <== 这里可以输出目前磁盘的状态 
Disk /dev/vda: 83886080 sectors, 40.0 GiB                     # 磁盘文件名/扇区数与总容量 
Logical sector size: 512 bytes                                # 单一扇区大小为 512 bytes  
Disk identifier (GUID): A4C3C813-62AF-4BFE-BAC9-112EBD87A483  # 磁盘的 GPT 标识符 
Partition table holds up to 128 entries 
First usable sector is 34, last usable sector is 83886046 
Partitions will be aligned on 2048-sector boundaries 
Total free space is 18862013 sectors (9.0 GiB) 

Number  Start (sector)    End (sector)  Size       Code  Name # 底下为完整的分区信息了！ 
   1            2048            6143   2.0 MiB     EF02       # 第一个分区槽数据 
   2            6144         2103295   1024.0 MiB  0700 
   3         2103296        65026047   30.0 GiB    8E00 
# 分区编号 开始扇区号码  结束扇区号码  容量大小 
Command (? for help): q 
# 想要不储存离开吗？按下 q 就对了！不要随便按 w 啊！ 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="第十二章、-学习Shell-Scripts"><a href="#第十二章、-学习Shell-Scripts" class="headerlink" title="第十二章、 学习Shell Scripts"></a>第十二章、 学习Shell Scripts</h1><h2 id="常用命令解析"><a href="#常用命令解析" class="headerlink" title="常用命令解析"></a>常用命令解析</h2><pre class="line-numbers language-shell"><code class="language-shell">sudo lsb_release -a　// look ubuntu version
uname -r  //kernal version

netstat –tln //查看服务监听端口
netstat      //查看进程号
ps –aux     //查看进程号
ps –aux | more //全部查看
ps –ef | grep mysql //查看mysql的进程
kill -9 3306 //强制杀掉进程号3306

# 查看80端口占用
netstat -apn|grep 80

diff -ruNa dir1  dir2 > s12.diff

#几种快速清空文件内容的方法
echo "" > fileName
echo /dev/null > fileName
echo > fileName
cat /dev/null > fileName
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>ln</strong></p>
<pre class="line-numbers language-shell"><code class="language-shell">ln -fs Target_file/Target_dir #在当前目录下新建一个同名链接
ln -fs Target_file/Target_dir  link_rename #指定链接名
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>tar</strong> 加压解压</p>
<pre class="line-numbers language-shell"><code class="language-shell"># bz2
压包：tar  -jcf  target.tar.bz2   target
解压：tar  -jxf  target.tar.bz2
# gz
压包：tar  -zcf  target.tar.gz   target
解压：tar  -zxf  target.tar.gz
# 解压或压包到指定目录： -C
tar  -zxf  target.tar.gz –C /home/dream123/Desktop/(目录)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>命令详解</p>
<pre class="line-numbers language-shell"><code class="language-shell">-x 解压
-t 查看内容
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><strong>grep</strong>  </p>
<ul>
<li><a href="https://www.cnblogs.com/ggjucheng/archive/2013/01/13/2856896.html" target="_blank" rel="noopener">linux grep命令详解</a> </li>
</ul>
<p><strong>awk </strong></p>
<p><strong>sed</strong><br> <a href="http://blog.itpub.net/519536/viewspace-558364/" target="_blank" rel="noopener">【Shell】sed使用心得</a><br>%s/.*/# &amp;/g 在整个文件的首行插入#<br>2,10s/Type/type/g #第2至第10行替换Type为type</p>
<h3 id="性能监控"><a href="#性能监控" class="headerlink" title="性能监控"></a>性能监控</h3><ul>
<li><p>uptime </p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@www ~]# uptime 
 15:47:19 up 69 days, 20:24,  1 user,  load average: 0.06, 0.08, 0.11
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li>15:47:19 系统时间</li>
<li>69 days, 20:24 运行时间</li>
<li><code>1 user</code> 一个终端连接（终端Terminal连接数）</li>
<li><code>0.06, 0.08, 0.11</code> 在过去1,5,15分钟内的系统平均负载（运行队列中的平均进程数）</li>
</ul>
</li>
<li><p>top</p>
<pre class="line-numbers language-sh"><code class="language-sh">top - 17:19:17 up 69 days, 21:55,  3 users,  load average: 0.02, 0.12, 0.13
Tasks: 259 total,   2 running, 257 sleeping,   0 stopped,   0 zombie
%Cpu(s):  10.0/4.6    15[|||||||                                              ]
KiB Mem :  5971944 total,  2069108 free,  1897640 used,  2005196 buff/cache
KiB Swap:  3998716 total,  3998716 free,        0 used.  3270516 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND     
 2383 joel      20   0 2311856 286256 168372 S  18.6  4.8  10:48.61 chromium-b+ 
 1916 joel      20   0 1520768 130752  73584 R  11.0  2.2   3:32.51 compiz      
  908 root      20   0  359740  46208  33532 S  10.3  0.8   3:37.90 Xorg        
 2542 joel      20   0 1346212 323796  99516 S  10.0  5.4   4:51.57 chromium-b+ 
 2039 joel       9 -11  507632  11780   8812 S   3.7  0.2   0:45.57 pulseaudio  
 2796 joel      20   0 1215292 157504  87592 S   3.7  2.6   0:53.10 chromium-b+
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol>
<li><p>top第一行命令, 如上uptime</p>
</li>
<li><p>top第二行命令介绍(进程信息)</p>
<pre class="line-numbers language-shell"><code class="language-shell">Tasks: 259 total(进程总数) 2 running(正在运行的进程数) 257 sleeping(睡眠的进程数) 0 stopped(停止的进程数) 0 zombie(僵尸进程数)
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>第三行命令介绍(CPU信息)</p>
<pre class="line-numbers language-shell"><code class="language-shell">%Cpu(s): 9.6 us－－>用户空间占用CPU百分比 4.5 sy－－>内核空间占用CPU百分比 0.0 ni－－>用户进程空间内改变过优先级的进程占用CPU百分比 85.7 id－－>空闲CPU百分比 0.3 wa－－>等待输入输出的CPU时间百分比 0.0 hi－－> 0.0 si－－> 0.0 st－－>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>第四、五行命令介绍(内存信息)</p>
<pre class="line-numbers language-shell"><code class="language-shell">KiB Mem : 5971944 total－－>物理内存总量 2114336 free－－>空闲内存总量 1833032 used－－>使用的物理内存总量 2024576 buff/cache－－>用作内核缓存的内存量 
KiB Swap: 3998716 total－－>交换区总量, 3998716 free－－>空闲交换区总量, 0 used－－>使用的交换区总量. 3327816 avail Mem－－>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>进程信息</p>
<pre class="line-numbers language-shell"><code class="language-shell">PID－－>进程ＩＤ 
USER－－>用户 
PR－－>优先级 
NI－－>nice值。负值表示高优先级，正值表示低优先级 
VIRT－－>进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES 
RES－－>进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA 
SHR－－>共享内存大小，单位kb 
S－－>进程状态。 D=不可中断的睡眠状态R=运行 S=睡眠T=跟踪/停止Z=僵尸进程 
%CPU－－>上次更新到现在的CPU时间占用百分比 
%MEM－－>进程使用的物理内存百分比 
TIME+－－>进程使用的CPU时间总计，单位1/100秒 
COMMAND－－>命令名/命令行
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</li>
<li><p>vmstat  - Report virtual memory statistics<br><img src="https://img-blog.csdn.net/20180611104357519?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NkMTk5MzA1MDg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="vmstat结果"></p>
<blockquote>
<p>vmstat 1 4 每一秒采集一次，共采集四次</p>
</blockquote>
</li>
</ul>
<h2 id="常用应用场景解析"><a href="#常用应用场景解析" class="headerlink" title="常用应用场景解析"></a>常用应用场景解析</h2><ul>
<li><p>变量获取，截取，替换，（没设置、空值、非空值） </p>
<ul>
<li><a href="https://blog.csdn.net/shmilyringpull/article/details/7631106" target="_blank" rel="noopener">shell中的${}，##和%%的使用</a></li>
</ul>
</li>
<li><p>Shell特殊变量：Shell $0, $#, $*, $@, $?, $和命令行参数  <a href="http://www.jb51.net/article/48686.htm" target="_blank" rel="noopener">bash shell命令行选项与修传入参数处理</a><br>|变量| 含义|<br>| —- | —- |<br>|$n | $1 the first parameter,$2 the second… |<br>|$# | The number of command-line parameters.  |<br>|$0 | The name of current program.            |<br>|$? | Last command or function’s return value.|<br>|$$ | The program’s PID.                      |<br>|$! | Last program’s PID.                     |<br>|$@ | Save all the parameters.                |</p>
</li>
<li><p><a href="https://www.cnblogs.com/wangkongming/p/4221503.html" target="_blank" rel="noopener">shell比较两个字符串是否相等</a></p>
</li>
<li>文档比较运算符  </li>
<li>if 命令参数说明</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.cnblogs.com/peida/tag/%E6%AF%8F%E6%97%A5%E4%B8%80linux%E5%91%BD%E4%BB%A4/default.html?page=1" target="_blank" rel="noopener">每日一linux命令</a></li>
</ul>
<h1 id="第十五章、例行性工作排程（crontab）"><a href="#第十五章、例行性工作排程（crontab）" class="headerlink" title="第十五章、例行性工作排程（crontab）"></a>第十五章、例行性工作排程（crontab）</h1><h2 id="仅执行一次的工作排程"><a href="#仅执行一次的工作排程" class="headerlink" title="仅执行一次的工作排程"></a>仅执行一次的工作排程</h2><h2 id="循环执行的例行性工作排程"><a href="#循环执行的例行性工作排程" class="headerlink" title="循环执行的例行性工作排程"></a>循环执行的例行性工作排程</h2><h2 id="可唤醒停机间工作的排程"><a href="#可唤醒停机间工作的排程" class="headerlink" title="可唤醒停机间工作的排程"></a>可唤醒停机间工作的排程</h2><h1 id="第二十章、基础系统设定与备份策略"><a href="#第二十章、基础系统设定与备份策略" class="headerlink" title="第二十章、基础系统设定与备份策略"></a>第二十章、基础系统设定与备份策略</h1><h2 id="20-1-系统基本设定"><a href="#20-1-系统基本设定" class="headerlink" title="20.1 系统基本设定"></a>20.1 系统基本设定</h2><h3 id="20-1-1-网络设置"><a href="#20-1-1-网络设置" class="headerlink" title="20.1.1 网络设置"></a>20.1.1 网络设置</h3><h4 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h4><pre class="line-numbers language-shell"><code class="language-shell">#hosts地址
/etc/hosts
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="nmcli"><a href="#nmcli" class="headerlink" title="nmcli"></a>nmcli</h4><blockquote>
<p>全称是”NetworkManage CommandLine Interface”</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">#1. nmcli device show 查看网络配置简写
nmcli d show 
#2. nmcli connection show 查看网络状态的简写
nmcli con show
# 3 查看网络设备状态
nmcli dev status 
# 4. 查看网络状态
nmcli dev status
# 5.快速修改连接配置
nmcli con mod “eth0” connection.autoconnect no
nmcli con mod “eth0” ipv4.dns 172.16.0.1
nmcli con mod “eth0” +ipv4.dns 8.8.8.8
nmcli con mod “eth0” -ipv4.dns 8.8.8.8
nmcli con mod “eth0” ipv4.addresses “172.25.X.10/24 172.25.X.254”
nmcli con mod “eth0” +ipv4.addresses 10.10.10.10/16
# 5.1 生效
nmcli con reload
#6 激活和禁用网卡
nmcli con down “system eth0” 可被自动激活
nmcli con up “system eth0”
nmcli dev dis eth0 禁用网卡，访止被自动激活
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>注意：如果出现<code>Error: NetworkManager is not running.</code> 重启network service <code>sudo /etc/init.d/network-manager restart</code>  修改完成后禁止NetworkMananger <code>systemctl disable NetworkManager</code></p>
<p>1） <strong>手动设定 IP 网络参数</strong></p>
<ol>
<li><p>查看指定网卡状态 <code>nmcli con show eth0</code>, 重要参数</p>
<pre class="line-numbers language-shell"><code class="language-shell">connection.autoconnect [yes|no]  ：是否于开机时启动这个联机，预设通常是  yes  才对！
ipv4.method [auto|manual]  ：自动还是手动设定网络参数
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>设置网络参数 <code>nmcli con modify eth0</code></p>
<pre class="line-numbers language-shell"><code class="language-shell">[root@study ~]# nmcli con modify eth0 \ 
>  connection.autoconnect yes \ 
>  ipv4.method manual \ 
>  ipv4.addresses 172.16.1.1/16 \ 
>  ipv4.gateway 172.16.200.254 \ 
>  ipv4.dns 172.16.200.254 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>生效 <code>nmcli con up eth0</code></p>
</li>
<li><p>验证是否生效 <code>nmcli con show eth0</code> </p>
</li>
</ol>
<p><strong>网络会话配置快速实现IP地址等网络配置的变更</strong></p>
<ol>
<li><p>新增网络会话,<code>ens192</code>为 <code>nmcli con show</code>  name 栏目下的硬件，设置<code>interface-name</code>网络接口</p>
<pre class="line-numbers language-shell"><code class="language-shell">nmcli con add con-name datacenter-daxing \
ifname ens192 autoconnect no type ethernet \
ip4 172.16.60.100/16 \
gw4 172.16.0.1\
ipv4.dns 202.101.172.35
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>开启会话 <code>nmcli con up datacenter-daxing</code></p>
</li>
<li><p>删除会话 <code>nmcli con del datacenter-daxing</code></p>
</li>
</ol>
<hr>
<h1 id="第二十一、章-软件安装"><a href="#第二十一、章-软件安装" class="headerlink" title="第二十一、章 软件安装"></a>第二十一、章 软件安装</h1><h2 id="常用软件安装"><a href="#常用软件安装" class="headerlink" title="常用软件安装"></a>常用软件安装</h2><ul>
<li><p>软件管理工具</p>
<p><a href="https://github.com/Linuxbrew/brew" target="_blank" rel="noopener">Homebrew for linux </a></p>
</li>
<li><p>编译工具</p>
<ul>
<li><p><a href="https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/01.1.md" target="_blank" rel="noopener">go 系统安装说明</a></p>
<pre class="line-numbers language-shell"><code class="language-shell">tar -C /usr/local -xzf go1.11.5.linux-amd64.tar.gz
export PATH=$PATH:/usr/local/go/bin
source $HOME/.profile
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
<li><p><a href="https://blog.csdn.net/laomd/article/details/80710451" target="_blank" rel="noopener">Ubuntu使用snap安装常用软件</a></p>
</li>
</ul>
<h3 id="VPN（翻墙）"><a href="#VPN（翻墙）" class="headerlink" title="VPN（翻墙）"></a>VPN（翻墙）</h3><h4 id="影梭"><a href="#影梭" class="headerlink" title="影梭"></a><strong>影梭</strong></h4><p><a href="http://shadowsocks.org/en/index.html" target="_blank" rel="noopener">Shadowsocks官网 有Client和Server下载，常用配置</a></p>
<p>Chrome插件：<a href="http://okzhjyy82.bkt.clouddn.com/SwitchyOptions.bak" target="_blank" rel="noopener">SwitchyOptions.bak下载</a><br><strong>Ubuntu直接安装</strong></p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo add-apt-repository ppa:hzwhuang/ss-qt5
sudo apt-get update
sudo apt-get install shadowsocks-qt5
ss-qt5
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="软件配置及使用"><a href="#软件配置及使用" class="headerlink" title="软件配置及使用"></a>软件配置及使用</h2><h3 id="常用配置-1"><a href="#常用配置-1" class="headerlink" title="常用配置"></a>常用配置</h3><ol>
<li><a href="http://www.linuxidc.com/Linux/2014-02/97349.htm" target="_blank" rel="noopener">Ubuntu下配置支持Windows访问的Samba共享</a></li>
</ol>
<h3 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h3><ul>
<li><p>～/.vimrc</p>
<ul>
<li>hi Comment ctermfg =blue #蓝色注释</li>
<li>git config –global core.editor vim</li>
<li>中文乱码  set fencs=utf-8,GB18030,ucs-bom,default,latin1</li>
<li>设置TAB<pre class="line-numbers language-shell"><code class="language-shell">set ts=4  (注：ts是tabstop的缩写，设TAB宽4个空格)
set expandtab
对于已保存的文件，可以使用下面的方法进行空格和TAB的替换：
TAB替换为空格：
:set ts=4
:set expandtab
:%retab!
空格替换为TAB：
:set ts=4
:set noexpandtab
:%retab!
加!是用于处理非空白字符之后的TAB，即所有的TAB，若不加!，则只处理行首的TAB。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
</li>
<li><p>常用命令</p>
<blockquote>
<p>vim  FileName  +LineNumber == vim + LineNumber Filename</p>
</blockquote>
</li>
</ul>
<h2 id="问题解决记录"><a href="#问题解决记录" class="headerlink" title="问题解决记录"></a>问题解决记录</h2><h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h3><ol>
<li>使用：<code>sudo apt-get install openvswitch-switch</code> 报错</li>
</ol>
<pre class="line-numbers language-shell"><code class="language-shell">E: Could not get lock /var/lib/dpkg/lock - open (11: Resource temporarily unavailable)
E: Unable to lock the administration directory (/var/lib/dpkg/), is another process using it?
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>解决：</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo rm /var/cache/apt/archives/lock
sudo rm /var/lib/dpkg/lock
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol start="2">
<li><p>ubuntu adb 安装<br>问题：adb devices: ?????? no permissions解决办法</p>
<p><strong>lsusb</strong> ： 查看USB的连接状态</p>
<pre class="line-numbers language-shell"><code class="language-shell">Bus 001 Device 003: ID 04f2:b5a7 Chicony Electronics Co., Ltd 
Bus 001 Device 006: ID 05c6:9091 Qualcomm, Inc. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 003: ID 0e0f:0002 VMware, Inc. Virtual USB Hub
Bus 002 Device 002: ID 0e0f:0003 VMware, Inc. Virtual Mouse
Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>设置USB</p>
<pre class="line-numbers language-shell"><code class="language-shell"># 编辑
sudo echo '"SUBSYSTEM=="usb", ATTR{idVendor}=="05c6", MODE="0666", GROUP="plugdev""' >>  /etc/udev/rules.d/70-android.rules
# 重启
sudo chmod a+rx /etc/udev/rules.d/70-android.rules
sudo service udev restart
# adb 重启
adb kill-server
adb devices
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上没有下过的都无效果，查看硬件手动重启USB调试是否正常<br>参考： <a href="https://www.jianshu.com/p/82fcb8dd8486" target="_blank" rel="noopener">adb devices: ?????? no permissions解决办法</a></p>
</li>
</ol>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><ul>
<li><a href="https://blog.csdn.net/sxhong/article/details/78355341" target="_blank" rel="noopener">Centos国内下载源</a></li>
<li><a href="https://blog.csdn.net/CSDN1887/article/details/81540311" target="_blank" rel="noopener">CentOS国内镜像-YUM源更新</a></li>
</ul>
<h2 id="日常解决问题"><a href="#日常解决问题" class="headerlink" title="日常解决问题"></a>日常解决问题</h2><ul>
<li><p>设置影梭代理</p>
<pre class="line-numbers language-shell"><code class="language-shell">#1.临时方案
export ALL_PROXY=socks5://127.0.0.1:1080
#永久方案
echo export ALL_PROXY=socks5://127.0.0.1:1080 >> ~/.bash_profile
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>ubuntu 下 su: Authentication failure</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo passwd root
Enter new UNIX password: 
Retype new UNIX password: 
passwd: password updated successfully
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ul>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p><strong>Linux termial shortcut</strong> 终端操作快捷键</p>
<table>
<thead>
<tr>
<th style="text-align:center">cmd</th>
<th style="text-align:center">function</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ctrl + a /&lt;-</td>
<td style="text-align:center">move to line head</td>
</tr>
<tr>
<td style="text-align:center">ctrl + e/-&gt;</td>
<td style="text-align:center">move to line tail</td>
</tr>
<tr>
<td style="text-align:center">ctrl + b /f</td>
<td style="text-align:center">move back/front  a char</td>
</tr>
<tr>
<td style="text-align:center">alt + b</td>
<td style="text-align:center">move back a word</td>
</tr>
<tr>
<td style="text-align:center">ctrl+w</td>
<td style="text-align:center">delete a word before cursor</td>
</tr>
<tr>
<td style="text-align:center">alt + d</td>
<td style="text-align:center">delete a word after cursor</td>
</tr>
<tr>
<td style="text-align:center">ctrl +k</td>
<td style="text-align:center">delete all word after cursor</td>
</tr>
</tbody>
</table>
<h2 id="学习资料"><a href="#学习资料" class="headerlink" title="学习资料"></a>学习资料</h2><h3 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h3><ul>
<li><a href="http://www.cnblogs.com/stephen-liu74/archive/2011/12/20/2285454.html" target="_blank" rel="noopener"> </a><a href="http://www.cnblogs.com/stephen-liu74/archive/2011/12/20/2285454.html" target="_blank" rel="noopener">Linux shell 常用技巧系列教程</a> </li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Basic/" rel="tag"># Basic</a>
          
            <a href="/tags/Linux/" rel="tag"># Linux</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/13/2019-4-13-netwok_pragram_note/" rel="next" title="网络编程笔记汇总">
                <i class="fa fa-chevron-left"></i> 网络编程笔记汇总
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/14/2019-4-14-Docker-note/" rel="prev" title="Docker学习笔记">
                Docker学习笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2019/04/13/2019-3-23-newbia-note/"
     data-title="Linux 菜鸟私房菜知识架构"
     data-content=""
     data-url="http://zhilinchn.online/2019/04/13/2019-3-23-newbia-note/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2019/04/13/2019-3-23-newbia-note/"
           data-title="Linux 菜鸟私房菜知识架构" data-url="http://zhilinchn.online/2019/04/13/2019-3-23-newbia-note/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ohlb58e07.bkt.clouddn.com/avatar_github_blog.jpg"
               alt="北疆" />
          <p class="site-author-name" itemprop="name">北疆</p>
          <p class="site-description motion-element" itemprop="description">自古以来，所谓豪杰之士，必有过人之节。人情有所不能忍着，匹夫见辱.拔剑而起.挺身而斗，此不足为勇也。天下有大勇者,猝然临之而不惊,无故加之而不怒。而其挟持者甚大，其志甚远也。 ——苏东坡《留候论》</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">50</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">59</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Orange168" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/bonanzas" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/53927a5b90c8/latest_articles" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  简书
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              常用网站
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://androidweekly.net/" title="Androidweekly English" target="_blank">Androidweekly English</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://androidweekly.cn/" title="Androidweekly Chinese" target="_blank">Androidweekly Chinese</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第五章、Linux-的文件权限与目录配置"><span class="nav-number">1.</span> <span class="nav-text">第五章、Linux  的文件权限与目录配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#用户管理"><span class="nav-number">1.1.</span> <span class="nav-text">用户管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#man-page"><span class="nav-number">1.2.</span> <span class="nav-text">man page</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件权限与配置"><span class="nav-number">1.3.</span> <span class="nav-text">文件权限与配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件与目录管理"><span class="nav-number">1.4.</span> <span class="nav-text">文件与目录管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cp-mv"><span class="nav-number">1.4.1.</span> <span class="nav-text">cp,mv</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件名与目录名称"><span class="nav-number">1.4.2.</span> <span class="nav-text">文件名与目录名称</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件内容查阅"><span class="nav-number">1.4.3.</span> <span class="nav-text">文件内容查阅</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件预设权限：umask"><span class="nav-number">1.4.4.</span> <span class="nav-text">文件预设权限：umask</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件隐藏属性"><span class="nav-number">1.4.5.</span> <span class="nav-text">文件隐藏属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#chattr"><span class="nav-number">1.4.5.1.</span> <span class="nav-text">chattr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#lsattr-显示文件隐藏属性"><span class="nav-number">1.4.5.2.</span> <span class="nav-text">lsattr (显示文件隐藏属性)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件特殊权限："><span class="nav-number">1.4.6.</span> <span class="nav-text">文件特殊权限：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#脚本文件名的搜寻"><span class="nav-number">1.5.</span> <span class="nav-text">脚本文件名的搜寻</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#which-寻找『执行档』"><span class="nav-number">1.5.1.</span> <span class="nav-text">which (寻找『执行档』)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#whereis-由一些特定的目录中寻找文件文件名"><span class="nav-number">1.5.2.</span> <span class="nav-text">whereis (由一些特定的目录中寻找文件文件名)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#locate-updatedb"><span class="nav-number">1.5.3.</span> <span class="nav-text">locate / updatedb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#find"><span class="nav-number">1.5.4.</span> <span class="nav-text">find</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第七章、Linux磁盘与文件系统"><span class="nav-number">2.</span> <span class="nav-text">第七章、Linux磁盘与文件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#EXT2-inode"><span class="nav-number">2.1.</span> <span class="nav-text">EXT2 inode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件系统的简单操作"><span class="nav-number">2.2.</span> <span class="nav-text">文件系统的简单操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#磁盘的分区、格式化、检验"><span class="nav-number">2.3.</span> <span class="nav-text">磁盘的分区、格式化、检验</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#gdisk"><span class="nav-number">2.3.1.</span> <span class="nav-text">gdisk</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第十二章、-学习Shell-Scripts"><span class="nav-number">3.</span> <span class="nav-text">第十二章、 学习Shell Scripts</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用命令解析"><span class="nav-number">3.1.</span> <span class="nav-text">常用命令解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#性能监控"><span class="nav-number">3.1.1.</span> <span class="nav-text">性能监控</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用应用场景解析"><span class="nav-number">3.2.</span> <span class="nav-text">常用应用场景解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">3.3.</span> <span class="nav-text">参考资料</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第十五章、例行性工作排程（crontab）"><span class="nav-number">4.</span> <span class="nav-text">第十五章、例行性工作排程（crontab）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#仅执行一次的工作排程"><span class="nav-number">4.1.</span> <span class="nav-text">仅执行一次的工作排程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#循环执行的例行性工作排程"><span class="nav-number">4.2.</span> <span class="nav-text">循环执行的例行性工作排程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可唤醒停机间工作的排程"><span class="nav-number">4.3.</span> <span class="nav-text">可唤醒停机间工作的排程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第二十章、基础系统设定与备份策略"><span class="nav-number">5.</span> <span class="nav-text">第二十章、基础系统设定与备份策略</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#20-1-系统基本设定"><span class="nav-number">5.1.</span> <span class="nav-text">20.1 系统基本设定</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#20-1-1-网络设置"><span class="nav-number">5.1.1.</span> <span class="nav-text">20.1.1 网络设置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用配置"><span class="nav-number">5.1.1.1.</span> <span class="nav-text">常用配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nmcli"><span class="nav-number">5.1.1.2.</span> <span class="nav-text">nmcli</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#第二十一、章-软件安装"><span class="nav-number">6.</span> <span class="nav-text">第二十一、章 软件安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常用软件安装"><span class="nav-number">6.1.</span> <span class="nav-text">常用软件安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#VPN（翻墙）"><span class="nav-number">6.1.1.</span> <span class="nav-text">VPN（翻墙）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#影梭"><span class="nav-number">6.1.1.1.</span> <span class="nav-text">影梭</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#软件配置及使用"><span class="nav-number">6.2.</span> <span class="nav-text">软件配置及使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常用配置-1"><span class="nav-number">6.2.1.</span> <span class="nav-text">常用配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vim"><span class="nav-number">6.2.2.</span> <span class="nav-text">vim</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#问题解决记录"><span class="nav-number">6.3.</span> <span class="nav-text">问题解决记录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#软件安装"><span class="nav-number">6.3.1.</span> <span class="nav-text">软件安装</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#附录"><span class="nav-number">7.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#日常解决问题"><span class="nav-number">7.1.</span> <span class="nav-text">日常解决问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用命令"><span class="nav-number">7.2.</span> <span class="nav-text">常用命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#学习资料"><span class="nav-number">7.3.</span> <span class="nav-text">学习资料</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#博客"><span class="nav-number">7.3.1.</span> <span class="nav-text">博客</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">北疆</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i> 访问人数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i> 访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span>次</span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"zhilinchn"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


</body>
</html>
